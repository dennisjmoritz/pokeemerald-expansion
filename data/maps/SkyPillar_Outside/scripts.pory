mapscripts SkyPillar_Outside_MapScripts {
    SkyPillar_Outside_OnTransition
    SkyPillar_Outside_OnLoad
    SkyPillar_Outside_OnFrame
}

script SkyPillar_Outside_EventScript_HideMapNamePopup {
	setflag FLAG_HIDE_MAP_NAME_POPUP
	return

}

script SkyPillar_Outside_EventScript_CheckSetAbnormalWeather {
	call_if_set FLAG_SYS_WEATHER_CTRL, Common_EventScript_SetAbnormalWeather
	return

}

script SkyPillar_Outside_EventScript_OpenDoor {
	setmetatile 14, 4, METATILE_Pacifidlog_SkyPillar_DoorOpen_Top, FALSE
	setmetatile 14, 5, METATILE_Pacifidlog_SkyPillar_DoorOpen_Bottom, FALSE
	return

}

script SkyPillar_Outside_EventScript_WallaceScene {
	lockall
	applymovement LOCALID_SKY_PILLAR_WALLACE, SkyPillar_Outside_Movement_WallaceApproachPlayer
	waitmovement 0
	applymovement LOCALID_PLAYER, Common_Movement_WalkInPlaceFasterLeft
	waitmovement 0
	msgbox SkyPillar_Outside_Text_OpenedDoorToSkyPillar, MSGBOX_DEFAULT
	closemessage
	delay 30
	setvar VAR_0x8004, 1  @ vertical pan
	setvar VAR_0x8005, 1  @ horizontal pan
	setvar VAR_0x8006, 8  @ num shakes
	setvar VAR_0x8007, 3  @ shake delay
	special ShakeCamera
	waitstate
	delay 40
	msgbox SkyPillar_Outside_Text_EarthquakeNotMomentToWaste, MSGBOX_DEFAULT
	closemessage
	applymovement LOCALID_PLAYER, SkyPillar_Outside_Movement_PlayerClimbSkyPillar
	applymovement LOCALID_SKY_PILLAR_WALLACE, SkyPillar_Outside_Movement_WallaceClimbSkyPillar
	waitmovement 0
	setvar VAR_0x8004, 1   @ vertical pan
	setvar VAR_0x8005, 3   @ horizontal pan
	setvar VAR_0x8006, 20  @ num shakes
	setvar VAR_0x8007, 5   @ shake delay
	special ShakeCamera
	waitstate
	delay 20
	applymovement LOCALID_SKY_PILLAR_WALLACE, Common_Movement_WalkInPlaceFasterLeft
	waitmovement 0
	delay 10
	applymovement LOCALID_SKY_PILLAR_WALLACE, Common_Movement_WalkInPlaceFasterRight
	waitmovement 0
	delay 20
	applymovement LOCALID_SKY_PILLAR_WALLACE, Common_Movement_WalkInPlaceFasterDown
	waitmovement 0
	delay 30
	msgbox SkyPillar_Outside_Text_SituationGettingWorse, MSGBOX_DEFAULT
	closemessage
	setflag FLAG_SYS_WEATHER_CTRL
	setweather WEATHER_ABNORMAL
	doweather
	special WaitWeather
	waitstate
	delay 30
	msgbox SkyPillar_Outside_Text_GotToGoBackForSootopolis, MSGBOX_DEFAULT
	closemessage
	playse SE_EXIT
	fadescreenswapbuffers FADE_TO_BLACK
	clearflag FLAG_HIDE_MAP_NAME_POPUP
	setvar VAR_SOOTOPOLIS_CITY_STATE, 4
	removeobject LOCALID_SKY_PILLAR_WALLACE
	clearflag FLAG_HIDE_SOOTOPOLIS_CITY_WALLACE
	fadescreenswapbuffers FADE_FROM_BLACK
	releaseall
	end

}

script SkyPillar_Outside_EventScript_Wallace {
	end

}

script SkyPillar_Outside_EventScript_ClosedDoor {
	msgbox SkyPillar_Outside_Text_DoorIsClosed, MSGBOX_SIGN
	end

}

text SkyPillar_Outside_Text_DoorIsClosed {
    format("The door is closed.")
}

text SkyPillar_Outside_Text_OpenedDoorToSkyPillar {
    format("WALLACE: Oh, my, I'm terribly sorry!\p In my haste, I didn't notice that I'd left you behind!\p I've opened the locked door of the SKY PILLAR.\p {PLAYER}{KUN}, let's be on our way!")
}

text SkyPillar_Outside_Text_EarthquakeNotMomentToWaste {
    format("WALLACE: It's an earthquake!\p There's not a moment to waste! We've got to hurry!")
}

text SkyPillar_Outside_Text_SituationGettingWorse {
    format("WALLACE: Hmm… The situation is getting worse…")
}

text SkyPillar_Outside_Text_GotToGoBackForSootopolis {
    format("WALLACE: This isn't good…\p The weather distortion is spreading even here…\p {PLAYER}{KUN}.\p RAYQUAZA should be farther up from here.\p I'm worried about SOOTOPOLIS. I've got to go back.\p Everything is in your hands now. Don't fail us!")
}

