mapscripts BattleFrontier_BattlePikeLobby_MapScripts {
    BattleFrontier_BattlePikeLobby_OnFrame
    BattleFrontier_BattlePikeLobby_OnWarp
}

script BattleFrontier_BattlePikeLobby_EventScript_TurnPlayerNorth {
	setvar VAR_TEMP_1, 1
	turnobject LOCALID_PLAYER, DIR_NORTH
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_GetChallengeStatus {
	frontier_getstatus
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_QuitWithoutSaving {
	special HealPlayerParty
	pike_resethelditems
	lockall
	msgbox BattleFrontier_BattlePikeLobby_Text_FailedToSaveBeforeQuitting, MSGBOX_DEFAULT
	closemessage
	pike_set PIKE_DATA_WIN_STREAK, 0
	pike_set PIKE_DATA_WIN_STREAK_ACTIVE, FALSE
	frontier_set FRONTIER_DATA_CHALLENGE_STATUS, 0
	setvar VAR_TEMP_CHALLENGE_STATUS, 255
	releaseall
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_WonChallenge {
	lockall
	frontier_isbrain
	goto_if_eq VAR_RESULT, TRUE, BattleFrontier_BattlePikeLobby_EventScript_DefeatedQueen
	msgbox BattleFrontier_BattlePikeLobby_Text_PossessLuckInAbundance, MSGBOX_DEFAULT
	waitmessage
	goto BattleFrontier_BattlePikeLobby_EventScript_GiveBattlePoints

}

script BattleFrontier_BattlePikeLobby_EventScript_DefeatedQueen {
	msgbox BattleFrontier_BattlePikeLobby_Text_SnatchedVictoryFromQueen, MSGBOX_DEFAULT
	waitmessage
}

script BattleFrontier_BattlePikeLobby_EventScript_GiveBattlePoints {
	msgbox BattleFrontier_BattlePikeLobby_Text_AwardYouTheseBattlePoints, MSGBOX_DEFAULT
	frontier_givepoints
	msgbox BattleFrontier_Text_ObtainedXBattlePoints, MSGBOX_GETPOINTS
	frontier_checkairshow
	pike_get PIKE_DATA_TOTAL_STREAKS
	addvar VAR_RESULT, 1
	pike_set PIKE_DATA_TOTAL_STREAKS, VAR_RESULT
	special LoadPlayerParty
	special HealPlayerParty
	callnative UpdateFollowingPokemon
	pike_resethelditems
	message BattleFrontier_BattlePikeLobby_Text_ShallRecordResults
	waitmessage
	pike_save 0
	playse SE_SAVE
	waitse
	msgbox BattleFrontier_BattlePikeLobby_Text_LookForwardToSeeingYou, MSGBOX_DEFAULT
	closemessage
	setvar VAR_TEMP_CHALLENGE_STATUS, 255
	releaseall
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_LostChallenge {
	lockall
	message BattleFrontier_BattlePikeLobby_Text_ChallengeEndedRecordResults
	waitmessage
	frontier_checkairshow
	frontier_set FRONTIER_DATA_BATTLE_NUM, 0
	pike_set PIKE_DATA_WIN_STREAK_ACTIVE, FALSE
	special LoadPlayerParty
	special HealPlayerParty
	callnative UpdateFollowingPokemon
	pike_resethelditems
	pike_save 0
	playse SE_SAVE
	waitse
	msgbox BattleFrontier_BattlePikeLobby_Text_LookForwardToSeeingYou, MSGBOX_DEFAULT
	closemessage
	setvar VAR_TEMP_CHALLENGE_STATUS, 255
	releaseall
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_Attendant {
	lock
	faceplayer
	setvar VAR_FRONTIER_FACILITY, FRONTIER_FACILITY_PIKE
	setvar VAR_FRONTIER_BATTLE_MODE, FRONTIER_MODE_SINGLES
	special SavePlayerParty
	msgbox BattleFrontier_BattlePikeLobby_Text_WelcomeToBattlePike, MSGBOX_DEFAULT
}

script BattleFrontier_BattlePikeLobby_EventScript_AskTakeChallenge {
	message BattleFrontier_BattlePikeLobby_Text_TakeChallenge
	waitmessage
	multichoice 17, 6, MULTI_CHALLENGEINFO, FALSE
	switch VAR_RESULT
	case 0, BattleFrontier_BattlePikeLobby_EventScript_TryEnterChallenge
	case 1, BattleFrontier_BattlePikeLobby_EventScript_ExplainChallenge
	case 2, BattleFrontier_BattlePikeLobby_EventScript_CancelChallenge
	case MULTI_B_PRESSED, BattleFrontier_BattlePikeLobby_EventScript_CancelChallenge

}

script BattleFrontier_BattlePikeLobby_EventScript_TryEnterChallenge {
	message BattleFrontier_BattlePikeLobby_Text_WhichChallengeMode
	waitmessage
	multichoice 17, 6, MULTI_LEVEL_MODE, FALSE
	switch VAR_RESULT
	case FRONTIER_LVL_TENT, BattleFrontier_BattlePikeLobby_EventScript_CancelChallenge
	case MULTI_B_PRESSED, BattleFrontier_BattlePikeLobby_EventScript_CancelChallenge
	frontier_checkineligible
	goto_if_eq VAR_0x8004, TRUE, BattleFrontier_BattlePikeLobby_EventScript_NotEnoughValidMons
	frontier_set FRONTIER_DATA_LVL_MODE, VAR_RESULT
	msgbox BattleFrontier_BattlePikeLobby_Text_PleaseChooseThreeMons, MSGBOX_DEFAULT
	fadescreen FADE_TO_BLACK
	callnative RemoveFollowingPokemon
	call BattleFrontier_EventScript_GetLvlMode
	copyvar VAR_0x8004, VAR_RESULT
	setvar VAR_0x8005, FRONTIER_PARTY_SIZE
	special ChoosePartyForBattleFrontier
	waitstate
	goto_if_eq VAR_RESULT, 0, BattleFrontier_BattlePikeLobby_EventScript_LoadPartyAndCancelChallenge
	msgbox BattleFrontier_BattlePikeLobby_Text_SaveBeforeChallenge, MSGBOX_YESNO
	switch VAR_RESULT
	case NO, BattleFrontier_BattlePikeLobby_EventScript_LoadPartyAndCancelChallenge
	case YES, BattleFrontier_BattlePikeLobby_EventScript_SaveBeforeChallenge
	case MULTI_B_PRESSED, BattleFrontier_BattlePikeLobby_EventScript_LoadPartyAndCancelChallenge

}

script BattleFrontier_BattlePikeLobby_EventScript_SaveBeforeChallenge {
	setvar VAR_TEMP_CHALLENGE_STATUS, 0
	setvar VAR_TEMP_1, 0
	frontier_set FRONTIER_DATA_SELECTED_MON_ORDER
	pike_init
	frontier_set FRONTIER_DATA_CHALLENGE_STATUS, CHALLENGE_STATUS_SAVING
	pike_set PIKE_DATA_WIN_STREAK_ACTIVE, TRUE
	pike_savehelditems
	frontier_set FRONTIER_DATA_PAUSED, FALSE
	special LoadPlayerParty
	closemessage
	delay 2
	call Common_EventScript_SaveGame
	setvar VAR_TEMP_CHALLENGE_STATUS, 255
	pike_savehelditems
	goto_if_eq VAR_RESULT, 0, BattleFrontier_BattlePikeLobby_EventScript_CancelChallengeSaveFailed
	special SavePlayerParty
	frontier_setpartyorder FRONTIER_PARTY_SIZE
	msgbox BattleFrontier_BattlePikeLobby_Text_StepThisWay, MSGBOX_DEFAULT
	closemessage
	frontier_settrainers
	call BattleFrontier_BattlePikeLobby_EventScript_WalkToCorridor
	special HealPlayerParty
	call BattleFrontier_BattlePike_EventScript_CloseCurtain
	warpsilent MAP_BATTLE_FRONTIER_BATTLE_PIKE_CORRIDOR, 6, 7
	setvar VAR_TEMP_CHALLENGE_STATUS, 0
	waitstate
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_ExplainChallenge {
	msgbox BattleFrontier_BattlePikeLobby_Text_ExplainBattlePike, MSGBOX_DEFAULT
	goto BattleFrontier_BattlePikeLobby_EventScript_AskTakeChallenge

}

script BattleFrontier_BattlePikeLobby_EventScript_NotEnoughValidMons {
	switch VAR_RESULT
	case FRONTIER_LVL_50, BattleFrontier_BattlePikeLobby_EventScript_NotEnoughValidMonsLv50
	case FRONTIER_LVL_OPEN, BattleFrontier_BattlePikeLobby_EventScript_NotEnoughValidMonsLvOpen

}

script BattleFrontier_BattlePikeLobby_EventScript_NotEnoughValidMonsLv50 {
	msgbox BattleFrontier_BattlePikeLobby_Text_NotEnoughValidMonsLv50, MSGBOX_DEFAULT
	goto BattleFrontier_BattlePikeLobby_EventScript_EndCancelChallenge

}

script BattleFrontier_BattlePikeLobby_EventScript_NotEnoughValidMonsLvOpen {
	msgbox BattleFrontier_BattlePikeLobby_Text_NotEnoughValidMonsLvOpen, MSGBOX_DEFAULT
	goto BattleFrontier_BattlePikeLobby_EventScript_EndCancelChallenge

}

script BattleFrontier_BattlePikeLobby_EventScript_CancelChallengeSaveFailed {
	frontier_set FRONTIER_DATA_CHALLENGE_STATUS, 0
	goto BattleFrontier_BattlePikeLobby_EventScript_CancelChallenge

}

script BattleFrontier_BattlePikeLobby_EventScript_LoadPartyAndCancelChallenge {
	special LoadPlayerParty
	callnative UpdateFollowingPokemon
}

script BattleFrontier_BattlePikeLobby_EventScript_CancelChallenge {
	msgbox BattleFrontier_BattlePikeLobby_Text_LookForwardToSeeingYou, MSGBOX_DEFAULT
}

script BattleFrontier_BattlePikeLobby_EventScript_EndCancelChallenge {
	release
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_ShowResults {
	lockall
	frontier_results FRONTIER_FACILITY_PIKE
	waitbuttonpress
	special RemoveRecordsWindow
	releaseall
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_WalkToCorridor {
	applymovement LOCALID_PIKE_LOBBY_ATTENDANT, BattleFrontier_BattlePikeLobby_Movement_AttendantWalkToCorridor
	applymovement LOCALID_PLAYER, BattleFrontier_BattlePikeLobby_Movement_PlayerWalkToCorridor
	waitmovement 0
	return

}

script BattleFrontier_BattlePikeLobby_EventScript_Hiker {
	msgbox BattleFrontier_BattlePikeLobby_Text_OneRoomAwayFromGoal, MSGBOX_NPC
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_Twin {
	msgbox BattleFrontier_BattlePikeLobby_Text_NeverHadToBattleTrainer, MSGBOX_NPC
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_Beauty {
	msgbox BattleFrontier_BattlePikeLobby_Text_ThinkAbilitiesUsefulHere, MSGBOX_NPC
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_RulesBoard {
	lockall
	msgbox BattleFrontier_BattlePikeLobby_Text_RulesAreListed, MSGBOX_DEFAULT
	goto BattleFrontier_BattlePikeLobby_EventScript_ReadRulesBoard
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_ReadRulesBoard {
	message BattleFrontier_BattlePikeLobby_Text_ReadWhichHeading
	waitmessage
	multichoice 16, 4, MULTI_BATTLE_PIKE_RULES, FALSE
	switch VAR_RESULT
	case 0, BattleFrontier_BattlePikeLobby_EventScript_RulesPokenavBag
	case 1, BattleFrontier_BattlePikeLobby_EventScript_RulesHeldItems
	case 2, BattleFrontier_BattlePikeLobby_EventScript_RulesMonOrder
	case 3, BattleFrontier_BattlePikeLobby_EventScript_ExitRules
	case MULTI_B_PRESSED, BattleFrontier_BattlePikeLobby_EventScript_ExitRules
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_RulesPokenavBag {
	msgbox BattleFrontier_BattlePikeLobby_Text_ExplainPokenavBagRules, MSGBOX_DEFAULT
	goto BattleFrontier_BattlePikeLobby_EventScript_ReadRulesBoard
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_RulesHeldItems {
	msgbox BattleFrontier_BattlePikeLobby_Text_ExplainHeldItemRules, MSGBOX_DEFAULT
	goto BattleFrontier_BattlePikeLobby_EventScript_ReadRulesBoard
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_RulesMonOrder {
	msgbox BattleFrontier_BattlePikeLobby_Text_ExplainMonOrderRules, MSGBOX_DEFAULT
	goto BattleFrontier_BattlePikeLobby_EventScript_ReadRulesBoard
	end

}

script BattleFrontier_BattlePikeLobby_EventScript_ExitRules {
	releaseall
	end

}

script BattleFrontier_BattlePike_EventScript_CloseCurtain {
	playse SE_PIKE_CURTAIN_CLOSE
	special CloseBattlePikeCurtain
	waitstate
	waitse
	return

}

text BattleFrontier_BattlePikeLobby_Text_WelcomeToBattlePike {
    format("Where the luck of TRAINERS is put to the test…\p Welcome to the BATTLE PIKE…\p I am your guide to the BATTLE PIKE…")
}

text BattleFrontier_BattlePikeLobby_Text_TakeChallenge {
    format("Would you like to take the Battle Choice challenge?")
}

text BattleFrontier_BattlePikeLobby_Text_ExplainBattlePike {
    format("Here we conduct an event we call the Battle Choice.\p The Battle Choice rules are very simple…\p Choose one of three paths and make your way to the goal room at the end\l of the BATTLE PIKE. It's that simple.\p However, what happens on the chosen path depends entirely on the luck\l of the challenger…\p If you reach the goal, you will be rewarded with Battle Points.\p If you want to interrupt your challenge, please have a word with\l our staff in the big rooms on the way.\p If you don't save before interrupting, you will be disqualified.")
}

text BattleFrontier_BattlePikeLobby_Text_LookForwardToSeeingYou {
    format("We look forward to seeing you on another occasion…")
}

text BattleFrontier_BattlePikeLobby_Text_WhichChallengeMode {
    format("You have the choice of two courses, Level 50 and Open Level.\l Which will you challenge?")
}

text BattleFrontier_BattlePikeLobby_Text_NotEnoughValidMonsLv50 {
    format("I beg your pardon, but…\p You do not have three eligible POKéMON for the Battle Choice event.\p You must have three different POKéMON of Level 50 or less to enter.\p They also must be holding different kinds of items.\p EGGS{STR_VAR_1} ineligible.\p Please come see me when you are ready…")
}

text BattleFrontier_BattlePikeLobby_Text_NotEnoughValidMonsLvOpen {
    format("I beg your pardon, but…\p You do not have three eligible POKéMON for the Battle Choice event.\p You must have three different POKéMON to enter.\p They also must be holding different kinds of items.\p EGGS{STR_VAR_1} ineligible.\p Please come see me when you are ready…")
}

text BattleFrontier_BattlePikeLobby_Text_PleaseChooseThreeMons {
    format("Please choose the three POKéMON you wish to enter in the challenge…")
}

text BattleFrontier_BattlePikeLobby_Text_SaveBeforeChallenge {
    format("Before starting your Battle Choice challenge, I must save the game.\l Is that acceptable?")
}

text BattleFrontier_BattlePikeLobby_Text_StepThisWay {
    format("Please step this way…")
}

text BattleFrontier_BattlePikeLobby_Text_ChallengeEndedRecordResults {
    format("Your challenge has ended…\p I shall record your results. Please wait…")
}

text BattleFrontier_BattlePikeLobby_Text_PossessLuckInAbundance {
    format("You have completed the challenge…\p I must say… You seem to possess luck in abundance…")
}

text BattleFrontier_BattlePikeLobby_Text_ShallRecordResults {
    format("I shall record your results. Please wait…")
}

text BattleFrontier_BattlePikeLobby_Text_AwardYouTheseBattlePoints2 {
    format("To commemorate your completion of the Battle Choice challenge, we award\l you these Battle Point(s)…")
}

text BattleFrontier_BattlePikeLobby_Text_ReachedBattlePointLimit {
    format("You appear to have reached the limit for Battle Points…\p Please exchange some Battle Points for prizes, then return…")
}

text BattleFrontier_BattlePikeLobby_Text_FailedToSaveBeforeQuitting {
    format("I beg your pardon, but…\p You failed to save before you quit your challenge the last time.\p Because of that, your challenge so far has been disqualified. I am sorry…")
}

text BattleFrontier_BattlePikeLobby_Text_SnatchedVictoryFromQueen {
    format("Congratulations…\p You have snatched victory from the PIKE QUEEN and cleared the event…")
}

text BattleFrontier_BattlePikeLobby_Text_AwardYouTheseBattlePoints {
    format("In recognition of your amazing luck, we award you these Battle Point(s)…")
}

text BattleFrontier_BattlePikeLobby_Text_OneRoomAwayFromGoal {
    format("Arrgh! I blew my chance! I was one room away from the goal!\p In this place, you'd better watch out for poison, freezing, and so on.")
}

text BattleFrontier_BattlePikeLobby_Text_NeverHadToBattleTrainer {
    format("I've completed the challenge 10 times now, but I've never had to battle\l a TRAINER once.")
}

text BattleFrontier_BattlePikeLobby_Text_ThinkAbilitiesUsefulHere {
    format("Listen! Listen!\p Don't you think that the special abilities of POKéMON will be useful\l here?")
}

text BattleFrontier_BattlePikeLobby_Text_TrainersWhicheverPathIChoose {
    format("What is this weird place? I can't figure it out at all!\p I've taken the challenge a bunch of times, but all I ever do is run into\l TRAINERS whichever path I choose.")
}

text BattleFrontier_BattlePikeLobby_Text_RulesAreListed {
    format("The Battle Choice's rules are listed.")
}

text BattleFrontier_BattlePikeLobby_Text_ReadWhichHeading {
    format("Which heading do you want to read?")
}

text BattleFrontier_BattlePikeLobby_Text_ExplainPokenavBagRules {
    format("The BAG and POKéNAV may not be used during a Battle Choice challenge.")
}

text BattleFrontier_BattlePikeLobby_Text_ExplainHeldItemRules {
    format("During a Battle Choice challenge, any BERRY or HERB held by POKéMON\l will be effective only once.")
}

text BattleFrontier_BattlePikeLobby_Text_ExplainMonOrderRules {
    format("During a Battle Choice challenge, the sequence of POKéMON cannot be\l changed.\p The sequence must be set before starting your challenge.")
}

