#events for RusturfTunnel

script RusturfTunnel_MapScripts {
	map_script MAP_SCRIPT_ON_TRANSITION, RusturfTunnel_OnTransition
	map_script MAP_SCRIPT_ON_FRAME_TABLE, RusturfTunnel_OnFrame
	.byte 0

}

script RusturfTunnel_EventScript_SetAquaGruntAndPeekoPos {
	setobjectxyperm LOCALID_RUSTURF_TUNNEL_PEEKO, 13, 4
	setobjectxyperm LOCALID_RUSTURF_TUNNEL_GRUNT, 13, 5
	return

}

script RusturfTunnel_EventScript_Wanda {
	lock
	faceplayer
	msgbox RusturfTunnel_Text_BoyfriendOnOtherSideOfRock, MSGBOX_DEFAULT
	closemessage
	applymovement VAR_LAST_TALKED, Common_Movement_FaceOriginalDirection
	waitmovement 0
	release
	end

}

script RusturfTunnel_EventScript_WandasBoyfriend {
	lock
	faceplayer
	goto_if_set FLAG_TEMP_1, RusturfTunnel_EventScript_AlreadySpokenTo
	setflag FLAG_TEMP_1
	msgbox RusturfTunnel_Text_WhyCantTheyKeepDigging, MSGBOX_DEFAULT
	closemessage
	applymovement VAR_LAST_TALKED, Common_Movement_FaceOriginalDirection
	waitmovement 0
	release
	end

}

script RusturfTunnel_EventScript_AlreadySpokenTo {
	msgbox RusturfTunnel_Text_ToGetToVerdanturf, MSGBOX_DEFAULT
	closemessage
	applymovement VAR_LAST_TALKED, Common_Movement_FaceOriginalDirection
	waitmovement 0
	release
	end

}

script RusturfTunnel_EventScript_ClearTunnelScene {
	lockall
	call_if_eq VAR_TEMP_1, 1, RusturfTunnel_EventScript_FaceWandasBoyfriend1
	call_if_eq VAR_TEMP_1, 2, RusturfTunnel_EventScript_FaceWandasBoyfriend2
	call_if_eq VAR_TEMP_1, 3, RusturfTunnel_EventScript_FaceWandasBoyfriend3
	call RusturfTunnel_EventScript_WandasBoyfriendNotice
	msgbox RusturfTunnel_Text_YouShatteredBoulderTakeHM, MSGBOX_DEFAULT
	call_if_eq VAR_TEMP_1, 2, RusturfTunnel_EventScript_WandasBoyfriendApproachPlayer
	call_if_eq VAR_TEMP_1, 3, RusturfTunnel_EventScript_WandasBoyfriendApproachPlayer
	giveitem ITEM_HM_STRENGTH
	setflag FLAG_RECEIVED_HM_STRENGTH
	msgbox RusturfTunnel_Text_ExplainStrength, MSGBOX_DEFAULT
	closemessage
	call_if_eq VAR_TEMP_1, 1, RusturfTunnel_EventScript_BoyfriendApproachWanda1
	call_if_eq VAR_TEMP_1, 2, RusturfTunnel_EventScript_BoyfriendApproachWanda2
	call_if_eq VAR_TEMP_1, 3, RusturfTunnel_EventScript_BoyfriendApproachWanda3
	msgbox RusturfTunnel_Text_WandaReunion, MSGBOX_DEFAULT
	closemessage
	call_if_eq VAR_TEMP_1, 1, RusturfTunnel_EventScript_WandaAndBoyfriendExit1
	call_if_eq VAR_TEMP_1, 2, RusturfTunnel_EventScript_WandaAndBoyfriendExit
	call_if_eq VAR_TEMP_1, 3, RusturfTunnel_EventScript_WandaAndBoyfriendExit
	call RusturfTunnel_EventScript_SetRusturfTunnelOpen
	releaseall
	end

}

script RusturfTunnel_EventScript_BoyfriendApproachWanda1 {
	applymovement LOCALID_PLAYER, RusturfTunnel_Movement_PlayerWatchBoyfriend1
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, RusturfTunnel_Movement_BoyfriendApproachWanda1
	waitmovement 0
	return

}

script RusturfTunnel_EventScript_BoyfriendApproachWanda2 {
	applymovement LOCALID_PLAYER, RusturfTunnel_Movement_PlayerWatchBoyfriend
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, RusturfTunnel_Movement_BoyfriendApproachWanda
	waitmovement 0
	applymovement LOCALID_RUSTURF_TUNNEL_WANDA, Common_Movement_WalkInPlaceFasterDown
	waitmovement 0
	return

}

script RusturfTunnel_EventScript_BoyfriendApproachWanda3 {
	applymovement LOCALID_PLAYER, RusturfTunnel_Movement_PlayerWatchBoyfriend
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, RusturfTunnel_Movement_BoyfriendApproachWanda
	waitmovement 0
	applymovement LOCALID_RUSTURF_TUNNEL_WANDA, Common_Movement_WalkInPlaceFasterDown
	waitmovement 0
	return

}

script RusturfTunnel_EventScript_FaceWandasBoyfriend1 {
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, Common_Movement_WalkInPlaceFasterUp
	waitmovement 0
	applymovement LOCALID_PLAYER, Common_Movement_WalkInPlaceFasterDown
	waitmovement 0
	return

}

script RusturfTunnel_EventScript_FaceWandasBoyfriend2 {
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, RusturfTunnel_Movement_BoyfriendFaceRight
	waitmovement 0
	return

}

script RusturfTunnel_EventScript_FaceWandasBoyfriend3 {
	return

}

script RusturfTunnel_EventScript_WandasBoyfriendApproachPlayer {
	closemessage
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, RusturfTunnel_Movement_WandasBoyfriendApproachPlayer
	waitmovement 0
	return

}

script RusturfTunnel_EventScript_WandaAndBoyfriendExit1 {
	applymovement LOCALID_RUSTURF_TUNNEL_WANDA, RusturfTunnel_Movement_WandaExit1
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, RusturfTunnel_Movement_WandasBoyfriendExit1
	waitmovement 0
	return

}

script RusturfTunnel_EventScript_WandaAndBoyfriendExit {
	applymovement LOCALID_PLAYER, RusturfTunnel_Movement_PlayerWatchWandaExit
	applymovement LOCALID_RUSTURF_TUNNEL_WANDA, RusturfTunnel_Movement_WandaExit
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, RusturfTunnel_Movement_WandasBoyfriendExit
	waitmovement 0
	return

}

script RusturfTunnel_EventScript_WandasBoyfriendNotice {
	playse SE_PIN
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, Common_Movement_ExclamationMark
	waitmovement 0
	applymovement LOCALID_RUSTURF_TUNNEL_WANDAS_BF, Common_Movement_Delay48
	waitmovement 0
	return

}

script RusturfTunnel_EventScript_TunnelBlockagePos1 {
	setvar VAR_TEMP_1, 1
	end

}

script RusturfTunnel_EventScript_TunnelBlockagePos2 {
	setvar VAR_TEMP_1, 2
	end

}

script RusturfTunnel_EventScript_TunnelBlockagePos3 {
	setvar VAR_TEMP_1, 3
	end

}

script RusturfTunnel_EventScript_AquaGruntBackUp {
	lockall
	setflag FLAG_SAFE_FOLLOWER_MOVEMENT
	msgbox RusturfTunnel_Text_ComeAndGetSome, MSGBOX_DEFAULT
	closemessage
	applymovement LOCALID_RUSTURF_TUNNEL_GRUNT, RusturfTunnel_Movement_GruntAndPeekoBackUp
	applymovement LOCALID_RUSTURF_TUNNEL_PEEKO, RusturfTunnel_Movement_GruntAndPeekoBackUp
	waitmovement 0
	copyobjectxytoperm LOCALID_RUSTURF_TUNNEL_GRUNT
	copyobjectxytoperm LOCALID_RUSTURF_TUNNEL_PEEKO
	setvar VAR_RUSTURF_TUNNEL_STATE, 3
	releaseall
	end

}

script RusturfTunnel_EventScript_Peeko {
	lock
	faceplayer
	waitse
	playmoncry SPECIES_WINGULL, CRY_MODE_NORMAL
	msgbox RusturfTunnel_Text_Peeko, MSGBOX_DEFAULT
	waitmoncry
	release
	end

}

script RusturfTunnel_EventScript_Grunt {
	lock
	faceplayer
	playbgm MUS_ENCOUNTER_AQUA, FALSE
	msgbox RusturfTunnel_Text_GruntIntro, MSGBOX_DEFAULT
	trainerbattle_no_intro TRAINER_GRUNT_RUSTURF_TUNNEL, RusturfTunnel_Text_GruntDefeat
	msgbox RusturfTunnel_Text_GruntTakePackage, MSGBOX_DEFAULT
	giveitem ITEM_DEVON_PARTS
	closemessage
	applymovement LOCALID_PLAYER, RusturfTunnel_Movement_PushPlayerAsideForGrunt
	applymovement LOCALID_RUSTURF_TUNNEL_GRUNT, RusturfTunnel_Movement_GruntEscape
	waitmovement 0
	removeobject LOCALID_RUSTURF_TUNNEL_GRUNT
	delay 50
	addobject LOCALID_RUSTURF_TUNNEL_BRINEY
	applymovement LOCALID_RUSTURF_TUNNEL_BRINEY, RusturfTunnel_Movement_BrineyApproachPeeko1
	waitmovement 0
	applymovement LOCALID_PLAYER, RusturfTunnel_Movement_PlayerMoveAsideForBriney
	applymovement LOCALID_RUSTURF_TUNNEL_BRINEY, RusturfTunnel_Movement_BrineyApproachPeeko2
	waitmovement 0
	msgbox RusturfTunnel_Text_PeekoGladToSeeYouSafe, MSGBOX_DEFAULT
	applymovement LOCALID_RUSTURF_TUNNEL_BRINEY, Common_Movement_FacePlayer
	waitmovement 0
	message RusturfTunnel_Text_ThankYouLetsGoHomePeeko
	waitmessage
	waitse
	playmoncry SPECIES_WINGULL, CRY_MODE_NORMAL
	waitbuttonpress
	waitmoncry
	closemessage
	applymovement LOCALID_PLAYER, RusturfTunnel_Movement_PlayerWatchBrineyExit
	applymovement LOCALID_RUSTURF_TUNNEL_BRINEY, RusturfTunnel_Movement_BrineyExit
	applymovement LOCALID_RUSTURF_TUNNEL_PEEKO, RusturfTunnel_Movement_PeekoExit
	waitmovement 0
	removeobject LOCALID_RUSTURF_TUNNEL_BRINEY
	removeobject LOCALID_RUSTURF_TUNNEL_PEEKO
	clearflag FLAG_DEVON_GOODS_STOLEN
	setflag FLAG_RECOVERED_DEVON_GOODS
	setvar VAR_RUSTBORO_CITY_STATE, 4
	setvar VAR_BRINEY_HOUSE_STATE, 1
	setflag FLAG_HIDE_ROUTE_116_MR_BRINEY
	release
	end

}

script RusturfTunnel_EventScript_Mike {
	trainerbattle_single TRAINER_MIKE_2, RusturfTunnel_Text_MikeIntro, RusturfTunnel_Text_MikeDefeat
	msgbox RusturfTunnel_Text_MikePostBattle, MSGBOX_AUTOCLOSE
	end

}

text RusturfTunnel_Text_ComeAndGetSome {
    format("What, are you coming? Come and get some, then!")
}

text RusturfTunnel_Text_Peeko {
    format("PEEKO: Pii pihyoh!")
}

text RusturfTunnel_Text_GruntIntro {
    format("Grah, keelhaul it all!\p That hostage POKéMON turned out to be worthless!\p And to think I made a getaway… In this tunnel to nowhere!\p Hey! You! So you want to battle me?")
}

text RusturfTunnel_Text_GruntDefeat {
    format("Urrrggh! My career in crime comes to a dead end!")
}

text RusturfTunnel_Text_GruntTakePackage {
    format("This is plain not right…\p The BOSS told me this would be a slick-and-easy job to pull.\p All I had to do was steal some package from DEVON.\p Tch! You want it back that badly, take it!")
}

text RusturfTunnel_Text_PeekoGladToSeeYouSafe {
    format("PEEKO! Am I glad to see you're safe!")
}

text RusturfTunnel_Text_ThankYouLetsGoHomePeeko {
    format("PEEKO owes her life to you!\p They call me MR. BRINEY. And, you are?\p … … … … … … … … … … … … … … … …\p Ah, so you are {PLAYER}{KUN}! I sincerely thank you!\p Now, if there's anything that troubles you, don't hesitate to tell me!\p You can usually find me in my cottage by the sea near PETALBURG WOODS.\p Come, PEEKO, we should make our way home.\p PEEKO: Pihyoh!")
}

text RusturfTunnel_Text_WhyCantTheyKeepDigging {
    format("… …\p Why can't they keep digging? Is the bedrock too hard?\p My beloved awaits me in VERDANTURF TOWN just beyond here…\p If RUSTBORO and VERDANTURF were joined by this tunnel, I could visit\l her every day…\p But this… What am I to do?")
}

text RusturfTunnel_Text_ToGetToVerdanturf {
    format("To get from RUSTBORO to VERDANTURF, you need to go to DEWFORD, then pass\l through SLATEPORT and MAUVILLE…")
}

text RusturfTunnel_Text_YouShatteredBoulderTakeHM {
    format("Wow! You shattered that boulder blocking the way.\p To show you how much I appreciate it, I'd like you to have this HM.")
}

text RusturfTunnel_Text_ExplainStrength {
    format("That HM contains STRENGTH.\p If a muscular POKéMON were to learn that, it would be able to move even\l large boulders.")
}

text RusturfTunnel_Text_WandaReunion {
    format("WANDA! Now I can see you anytime!\p WANDA: That's…wonderful.\p Please, take some rest at my home.")
}

text RusturfTunnel_Text_BoyfriendOnOtherSideOfRock {
    format("On the other side of this rock… My boyfriend is there.\p He… He's not just digging the tunnel to come see me.\p He works his hands raw and rough for the benefit of everyone.")
}

text RusturfTunnel_Text_MikeIntro {
    format("What do you call a wild man up in the mountains? A mountain man, right?\p So why don't they call a POKéMON in the mountains a mountain POKéMON?")
}

text RusturfTunnel_Text_MikeDefeat {
    format("My POKéMON… Ran out of power…")
}

text RusturfTunnel_Text_MikePostBattle {
    format("They halted development here to protect POKéMON, right?\l There's a feel-good story!")
}

