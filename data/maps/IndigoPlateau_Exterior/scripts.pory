mapscripts IndigoPlateau_Exterior_MapScripts {
    IndigoPlateau_Exterior_OnTransition
    IndigoPlateau_Exterior_OnFrame
}

script IndigoPlateau_Exterior_OnTransition {
	setworldmapflag FLAG_TEMP_1
// Replaced FLAG_WORLD_MAP_INDIGO_PLATEAU_EXTERIOR with FLAG_TEMP_1
	call_if_eq VAR_TEMP_0, 1, IndigoPlateau_Exterior_EventScript_PlayCreditsMusic
// Replaced VAR_MAP_SCENE_INDIGO_PLATEAU_EXTERIOR with VAR_TEMP_0
	end

}

script IndigoPlateau_Exterior_EventScript_PlayCreditsMusic {
	playbgm MUS_CREDITS, 0
	return

}

script IndigoPlateau_Exterior_OnFrame {
	map_script_2 VAR_TEMP_0, 1, IndigoPlateau_Exterior_EventScript_Credits
// Replaced VAR_MAP_SCENE_INDIGO_PLATEAU_EXTERIOR with VAR_TEMP_0
	.2byte 0


@ After beating the champion, you are warped to the main
@ entrance of Indigo Plateau. This script starts running
@ immediately after your walking animation.
@ The script is timed to the music.
}

script IndigoPlateau_Exterior_EventScript_Credits {
	lockall
	delay 105

	@ Rival exits building. Spawn a dummy object to lock the camera.
	opendoor 11, 6
	waitdooranim
	special SpawnCameraObject
	addobject LOCALID_CREDITS_RIVAL
	applymovement LOCALID_CREDITS_RIVAL, IndigoPlateau_Exterior_Movement_RivalExitBuilding
	applymovement LOCALID_PLAYER, IndigoPlateau_Exterior_Movement_PushPlayerOutOfWay
	waitmovement 0
	closedoor 11, 6
	waitdooranim

	@ Rival runs off
	applymovement LOCALID_PLAYER, IndigoPlateau_Exterior_Movement_PlayerWatchRivalLeave
	applymovement LOCALID_CREDITS_RIVAL, IndigoPlateau_Exterior_Movement_RivalLeave
	waitmovement 0
	delay 100

	@ Oak exits building
	opendoor 11, 6
	waitdooranim
	addobject LOCALID_CREDITS_PROF_OAK
	applymovement LOCALID_CREDITS_PROF_OAK, IndigoPlateau_Exterior_Movement_OakExitBuilding
	waitmovement 0
	closedoor 11, 6
	waitdooranim
	delay 160

	@ Oak looks at player, then walks off
	applymovement LOCALID_PLAYER, IndigoPlateau_Exterior_Movement_PlayerWatchOakLeave
	applymovement LOCALID_CREDITS_PROF_OAK, IndigoPlateau_Exterior_Movement_OakLeave
	waitmovement 0
	delay 100

	@ Player begin to leave
	applymovement LOCALID_PLAYER, IndigoPlateau_Exterior_Movement_PlayerBeginLeave
	waitmovement 0
	delay 155
	applymovement LOCALID_PLAYER, IndigoPlateau_Exterior_Movement_PlayerFaceLeague
	waitmovement 0
	delay 90

	@ Player runs off
	applymovement LOCALID_PLAYER, IndigoPlateau_Exterior_Movement_PlayerTurnAround
	waitmovement 0
	applymovement LOCALID_PLAYER, IndigoPlateau_Exterior_Movement_PlayerLeave
	waitmovement 0

	@ Reset the map state and roll the credits
	special RemoveCameraObject
	setvar VAR_TEMP_0, 0
// Replaced VAR_MAP_SCENE_INDIGO_PLATEAU_EXTERIOR with VAR_TEMP_0
	removeobject LOCALID_CREDITS_RIVAL
	removeobject LOCALID_CREDITS_PROF_OAK
// FIXME undefined reference: 	special DoCredits
	waitstate
	releaseall
	end

}

script IndigoPlateau_Exterior_Movement_PlayerLeave {
	player_run_down
	player_run_down
	player_run_down
	player_run_down
	player_run_down
	player_run_down
	step_end

@ Unused
}

script IndigoPlateau_Exterior_Movement_PlayerExitBuilding {
	walk_down
	walk_down
	step_end

}

script IndigoPlateau_Exterior_Movement_PlayerWatchRivalLeave {
	delay_16
	delay_4
	walk_in_place_faster_down
	step_end

}

script IndigoPlateau_Exterior_Movement_PlayerWatchOakLeave {
	delay_8
	walk_in_place_faster_right
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	walk_in_place_faster_down
	step_end

}

script IndigoPlateau_Exterior_Movement_PlayerBeginLeave {
	walk_right
	delay_16
	walk_down
	walk_down
	delay_16
	delay_16
	step_end

}

script IndigoPlateau_Exterior_Movement_PlayerTurnAround {
	walk_in_place_faster_down
	step_end

}

script IndigoPlateau_Exterior_Movement_PushPlayerOutOfWay {
	face_right
	lock_facing_direction
	walk_left
	unlock_facing_direction
	step_end

}

script IndigoPlateau_Exterior_Movement_PlayerFaceLeague {
	walk_in_place_faster_up
	step_end

}

script IndigoPlateau_Exterior_Movement_RivalLeave {
	walk_fast_down
	walk_fast_down
	walk_fast_down
	walk_fast_down
	walk_fast_down
	walk_fast_down
	walk_fast_down
	step_end

}

script IndigoPlateau_Exterior_Movement_RivalExitBuilding {
	walk_fast_down
	step_end

}

script IndigoPlateau_Exterior_Movement_OakLeave {
	walk_in_place_faster_left
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	delay_16
	walk_in_place_faster_down
	delay_16
	walk_down
	walk_down
	walk_down
	walk_down
	walk_down
	walk_down
	walk_down
	step_end

}

script IndigoPlateau_Exterior_Movement_OakExitBuilding {
	walk_down
	step_end
}

